/*
 *             Copyright (c) 2016 - 2021, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import _0x144604 from'@ckeditor/ckeditor5-core/src/command';import{getStyles as _0x22cd24,getConverterOptions as _0xe7a71a}from'./utils';export default class c extends _0x144604{constructor(_0x3b641e){super(_0x3b641e),this['set']('isBusy',!0x1);}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x58dd89={}){const _0x1bdada=this['editor'],t=_0x1bdada['t'],_0x415ae3=_0x58dd89['converterUrl']||'https://docx-converter.cke-cs.com/v1/convert',_0x28131f=_0x58dd89['converterOptions']||{},_0x3af99f=_0x1bdada['plugins']['get']('ExportWord'),_0x2ed7aa=_0x58dd89['token']||_0x3af99f['_token'],_0x22104c=!0x1!==_0x28131f['auto_pagination'];return this['isBusy']=!0x0,this['refresh'](),_0x22cd24(_0x58dd89['stylesheets']||['EDITOR_STYLES'])['then'](_0x3697b6=>{const _0x23456a=_0x1bdada['getData']({'pagination':_0x22104c}),_0x356a68={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x1bdada['locale']['contentLanguageDirection']+'\x22>'+_0x23456a+'</div>','css':_0x3697b6,'options':{..._0x28131f,..._0xe7a71a(_0x1bdada)}},_0x4e397f={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x2ed7aa?{'Authorization':_0x2ed7aa['value']}:null},'body':JSON['stringify'](_0x356a68)};return window['fetch'](_0x415ae3,_0x4e397f)['then'](_0x2b8191=>{if(0xc8!==_0x2b8191['status'])throw _0x2b8191;return _0x2b8191['blob']();})['then'](_0x559fc9=>{this['o'](_0x559fc9,_0x58dd89['fileName']||'document.docx');});})['catch'](_0x1e740b=>{throw _0x1bdada['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x1e740b;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['o'](_0x597ea9,_0x26cc16){const _0x379d32=document['createElement']('a');_0x379d32['href']=window['URL']['createObjectURL'](_0x597ea9),_0x379d32['download']=_0x26cc16,_0x379d32['click'](),_0x379d32['remove']();}}